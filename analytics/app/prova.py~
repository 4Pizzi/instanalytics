import json
from polls.app.src import endpoint
from polls.app.src.request_handler import send_requests
from polls.app.src.request_handler import request as rq
from polls.profiles import dir
from polls.app.src.parser import profiling

def insert_username(username):
    profile_name = username
    profile_name.replace(" ", "")
    url = endpoint.request_account_info(profile_name)
    if send_requests.is_requested:
        rq.user_request(url, profile_name)
        print("Send request ...")
    return load_json(username)

def load_json(username):
    try:
        with open(dir.abs_path + '\\' + username + '\\' + username + '.json', 'r') as file:
            data = json.load(file)
            context = profiling.get_user_data(data)
    except FileNotFoundError as e:
        print(e)
    return context



